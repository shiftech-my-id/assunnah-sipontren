import{x as I,E as O,al as B,a3 as F,am as Q,an as T,N as h,b as w,ao as D,D as _,ap as j,I as A,J as V,aq as K,w as N}from"./index-910RbcJe.js";import{d as R,G as $,H as z,f as L,v as k,l as b,D as G,K as H,y as C,T as J}from"./vendor1-C_5Gv7FW.js";const Y=I({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:o,emit:t}){const f=k(),l=R(null);let n=0;const s=[];function r(a){const m=typeof a=="boolean"?a:e.noErrorFocus!==!0,p=++n,x=(i,c)=>{t(`validation${i===!0?"Success":"Error"}`,c)},E=i=>{const c=i.validate();return typeof c.then=="function"?c.then(g=>({valid:g,comp:i}),g=>({valid:!1,comp:i,err:g})):Promise.resolve({valid:c,comp:i})};return(e.greedy===!0?Promise.all(s.map(E)).then(i=>i.filter(c=>c.valid!==!0)):s.reduce((i,c)=>i.then(()=>E(c).then(g=>{if(g.valid===!1)return Promise.reject(g)})),Promise.resolve()).catch(i=>[i])).then(i=>{if(i===void 0||i.length===0)return p===n&&x(!0),!0;if(p===n){const{comp:c,err:g}=i[0];if(g!==void 0&&console.error(g),x(!1,c),m===!0){const P=i.find(({comp:q})=>typeof q.focus=="function"&&B(q.$)===!1);P!==void 0&&P.comp.focus()}}return!1})}function d(){n++,s.forEach(a=>{typeof a.resetValidation=="function"&&a.resetValidation()})}function u(a){a!==void 0&&F(a);const m=n+1;r().then(p=>{m===n&&p===!0&&(e.onSubmit!==void 0?t("submit",a):a!==void 0&&a.target!==void 0&&typeof a.target.submit=="function"&&a.target.submit())})}function v(a){a!==void 0&&F(a),t("reset"),G(()=>{d(),e.autofocus===!0&&e.noResetFocus!==!0&&y()})}function y(){Q(()=>{if(l.value===null)return;const a=l.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||l.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||l.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(l.value.querySelectorAll("[tabindex]"),m=>m.tabIndex!==-1);a!=null&&a.focus({preventScroll:!0})})}H(T,{bindComponent(a){s.push(a)},unbindComponent(a){const m=s.indexOf(a);m!==-1&&s.splice(m,1)}});let S=!1;return $(()=>{S=!0}),z(()=>{S===!0&&e.autofocus===!0&&y()}),L(()=>{e.autofocus===!0&&y()}),Object.assign(f.proxy,{validate:r,resetValidation:d,submit:u,reset:v,focus:y,getValidationComponents:()=>s}),()=>b("form",{class:"q-form",ref:l,onSubmit:u,onReset:v},O(o.default))}}),M=()=>{const e=w();Object.keys(e.props.errors)[0]&&setTimeout(()=>{const t=document.querySelector(".q-field--error input");t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.focus())},0)};function Z(e){const{form:o,url:t,onSuccess:f,onError:l,method:n,forceFormData:s}=e;o.clearErrors(),o[n??"post"](t,{preserveScroll:!0,forceFormData:s??!1,onSuccess:r=>{typeof f=="function"&&f(r)},onError:r=>{var d,u;typeof l=="function"&&l(r),M(),!(!r||typeof((d=r.response)==null?void 0:d.data)=="object"||r.message===void 0||((u=r.message)==null?void 0:u.length)===0)&&h.create({message:r.message,icon:"info",color:"negative",actions:[{icon:"close",color:"white",round:!0,dense:!0}]})}})}function ee(e){const{message:o,url:t,fetchItemsCallback:f,loading:l}=e;_.create({title:"Konfirmasi",icon:"question",message:o,focus:"cancel",cancel:!0,persistent:!0}).onOk(()=>{l.value=!0,D.post(t).then(n=>{h.create(n.data.message),f()}).finally(()=>{l.value=!1}).catch(n=>{let s="";n.response.data&&n.response.data.message?s=n.response.data.message:n.message&&(s=n.message),s.length>0&&h.create({message:s,color:"red"}),console.log(n)})})}function te(e){const{pagination:o,props:t,rows:f,url:l,loading:n,filter:s}=e;let r=t?t.pagination:o.value,d={page:r.page,per_page:r.rowsPerPage,order_by:r.sortBy,order_type:r.descending?"desc":"asc",filter:s};n.value=!0,D.get(l,{params:d}).then(u=>{f.value=u.data.data,o.value.page=u.data.current_page,o.value.rowsPerPage=u.data.per_page,o.value.rowsNumber=u.data.total,t&&(o.value.sortBy=t.pagination.sortBy,o.value.descending=t.pagination.descending)}).finally(()=>{n.value=!1})}const ae=I({name:"QInnerLoading",props:{...A,...j,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(e,{slots:o}){const t=k(),f=V(e,t.proxy.$q),{transitionProps:l,transitionStyle:n}=K(e),s=C(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(f.value===!0?" q-inner-loading--dark":"")),r=C(()=>"q-inner-loading__label"+(e.labelClass!==void 0?` ${e.labelClass}`:""));function d(){const v=[b(N,{size:e.size,color:e.color})];return e.label!==void 0&&v.push(b("div",{class:r.value,style:e.labelStyle},[e.label])),v}function u(){return e.showing===!0?b("div",{class:s.value,style:n.value},o.default!==void 0?o.default():d()):null}return()=>b(J,l.value,u)}}),oe=(...e)=>{let t=w().url;return t.indexOf("?")===-1?{}:(t=t.substring(t.indexOf("?")+1),Object.assign(Object.fromEntries(new URLSearchParams(t)),...e))};async function ne(e){const o=e.getNativeElement();o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),o.focus())}export{Y as Q,ae as a,te as b,ee as c,oe as g,Z as h,ne as s};
